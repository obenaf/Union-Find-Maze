<!DOCTYPE html>
<html>

<head>
   <meta charset="UTF-8">

   <style>
      .grid {
         margin: 1em auto;
         border-collapse: collapse
      }

      .grid td {
         cursor: pointer;
         width: 30px;
         height: 30px;
         border: 1px solid #ccc;
         text-align: center;
         font-family: sans-serif;
         font-size: 13px
      }

      .grid td.start {
         background-color: blue !important;
      }

      .grid td.clicked {
         border: none;
         background-color: black;
         font-weight: bold;
         color: white;
      }

      .grid td.unclicked {}

      .grid td.end {
         background-color: red;
      }
   </style>

   <script>
        function Create2DArray(rows) {
        var arr = [];

        for (var i=0;i<rows;i++) {
           arr[i] = [];
        }

        return arr;
      }
      //I honestly have no idea how this works
      //JavaScript, tis a silly place
      function clearGrid() {
         var x = document.getElementsByClassName("clicked");
         while (x) {
            x[0].className = "";
         }
      }

      function assimilate(classname) {
         var i = 0;
         var x = document.getElementsByClassName(classname);
         while (i < x.length) {
            x[0].className = "start";

            i++;
         }
      }


      var colorArray = ['#000000', '#0000FF'];
      var classArray = Create2DArray(18);

      window.onload = function() {
         document.getElementById("refreshBtn").addEventListener('click', clearGrid);

         var grid = clickableGrid(16, 16, function(el, row, col, i) {

            if (classArray[row][col+1] == 0 || classArray[row+1][col] == 0 || classArray[row-1][col] == 0 || classArray[row][col-1] == 0) {
               assimilate(el.className);
               el.className = "start";
               for (var i = 0; i < 16; i++) {
                  for(var q= 0; q < 16; q++){
                     if (classArray[i][q] == classArray[row][col]) {
                        classArray[i][q] = 0;
                     }
                  }
               }
               classArray[row][col] = 0;
            } else {

            }
         });

         document.body.appendChild(grid);


         function clickableGrid(rows, cols, callback) {
            for (var x = 1; x < 256; x++) {
               colorArray.push('#' + Math.floor(Math.random() * 16777215).toString(16));
            }
            for (x = 0; x < 128; x++) {

            }
            var classNum;
            var i = 1;
            var grid = document.createElement('table');
            grid.className = 'grid';
            for (var r = 0; r < rows; ++r) {
               var tr = grid.appendChild(document.createElement('tr'));
               for (var c = 0; c < cols; ++c) {
                  i++;
                  classNum = i;
                  var cell = tr.appendChild(document.createElement('td'));

                  if (r == 0 && c == 0) {
                     cell.className = "start";
                     classNum = 0;
                     classArray[0][0] = 0;
                  } else if (r == 15 && c == 15) {

                  }

                  if (typeof classArray[c][r] == 'undefined') {
                     classArray[c][r] = classNum;
                     cell.classList.add(classNum.toString(3));
                  } else {
                     classNum = classArray[c][r];
                     cell.classList.add(classNum.toString(3));
                  }
                  if (r != 15 && c != 15) {
                     var seed = Math.ceil(Math.random() * 3)
                     if (seed == 1) {
                        classArray[c+1][r] = classNum;
                     } else if (seed == 2) {
                        classArray[c][r+1] = classNum;
                     } else if (seed == 3) {

                     }
                  }
                  cell.style.backgroundColor = colorArray[classArray[c][r]];

                  cell.addEventListener('click', (function(el, r, c, i) {
                     return function() {
                        callback(el, r, c, i);
                     }
                  })(cell, r, c, i), false);
               }
            }
            return grid;
         }

      }
   </script>

</head>
<button id="refreshBtn" onclick="refreshEvent">Refresh</button>

</html>
